<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Create Account - Nexa Bank</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #062045, #0a3781);
            font-family: "Segoe UI", sans-serif;
        }

        .main-wrapper {
            display: flex;
            width: 1100px;
            height: 700px;
            background: white;
            border-radius: 20px;
            overflow: hidden;
        }

        /* LEFT PANEL */
        .left-panel {
            width: 35%;
            background: linear-gradient(135deg, #0b3a84, #062045);
            color: white;
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .left-panel img {
            width: 160px;
            border-radius: 20px;
            border: 4px solid #f5c542;
            margin-bottom: 20px;
            box-shadow: 0 0 25px rgba(245,197,66,0.6);
        }

        .left-panel h1 {
            font-size: 32px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .left-panel p {
            font-size: 15px;
            width: 80%;
            opacity: 0.85;
        }

        /* RIGHT PANEL FORM */
        .form-card {
            width: 65%;
            padding: 40px 50px;
        }

        .form-card h2 {
            text-align: center;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 30px;
            color: #062045;
        }

        /* GRID FIX (NO OVERLAP) */
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        input, select {
            padding: 14px;
            border-radius: 10px;
            border: 1px solid #c9c9c9;
            width: 100%;
            box-sizing: border-box;   /* FIX OVERLAP */
            font-size: 15px;
        }

        input:focus, select:focus {
            border-color: #0b3a84;
            box-shadow: 0 0 8px rgba(11,58,132,0.2);
            outline: none;
        }

        /* ADDRESS FULL WIDTH */
        .full-width {
            width: 100%;
            margin-bottom: 25px;
            box-sizing: border-box;
        }

        /* PIN TITLE */
        .pin-title {
            font-size: 17px;
            font-weight: 600;
            color: #062045;
            margin-bottom: 8px;
        }

        /* PIN BOXES */
        .pin-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .pin-box {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            border: 1px solid #c9c9c9;
            text-align: center;
            font-size: 22px;
            font-weight: bold;
        }

        .pin-box:focus {
            border-color: #0b3a84;
            box-shadow: 0 0 8px rgba(11,58,132,0.2);
        }

        .pin-eye {
            font-size: 20px;
            cursor: pointer;
            color: #444;
        }

        /* BUTTON */
        .btn-submit {
            width: 100%;
            padding: 15px;
            background: #f7d65b;
            border: none;
            border-radius: 12px;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
        }

        .btn-submit:hover {
            background: #ffdd4d;
        }
    </style>
</head>

<body>

<div class="main-wrapper">

    <!-- LEFT SIDE -->
    <div class="left-panel">
        <img th:src="@{/bank.png}" alt="Bank Logo">
        <h1>Nexa Bank</h1>
        <p>Create your modern, secure digital bank account in just a few steps.</p>
    </div>

    <!-- RIGHT SIDE FORM -->
    <div class="form-card">

        <h2>Open New Account</h2>

        <form th:action="@{/major/send-otp}" th:object="${account}" method="post">

            <!-- ROW 1 -->
            <div class="grid-2">
                <input type="text" th:field="*{holderName}" placeholder="Full Name"
                       required pattern="[A-Za-z ]{3,}"
                       title="Only letters allowed, min 3 characters">

                <input type="email" th:field="*{email}" placeholder="Email" required>
            </div>

            <!-- ROW 2 -->
            <div class="grid-2">
                <input type="text" th:field="*{phoneNumber}" placeholder="Phone Number"
                       maxlength="10" required pattern="[0-9]{10}"
                       title="Phone must be 10 digits">

                <input type="date" id="dobField" th:field="*{dob}" required>

            </div>

            <!-- ROW 3 -->
            <div class="grid-2">
                <select th:field="*{accountType}" required>
                    <option value="" disabled selected>Select Account Type</option>
                    <option value="Savings">Savings</option>
                    <option value="Current">Current</option>
                    <option value="Salary">Salary</option>
                </select>

                <select th:field="*{branchName}" required>
                    <option value="" disabled selected>Select Branch</option>
                    <option value="Chennai - Tambaram">Chennai - Tambaram</option>
                    <option value="Bangalore - Whitefield">Bangalore - Whitefield</option>
                    <option value="Mumbai - Andheri">Mumbai - Andheri</option>
                    <option value="Delhi - Rohini">Delhi - Rohini</option>
                </select>
            </div>

            <!-- ROW 4 -->
            <div class="grid-2">
                <select th:field="*{gender}" required>
                    <option value="" disabled selected>Select Gender</option>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                    <option value="Others">Others</option>
                </select>

                <input type="text" th:field="*{aadharNumber}" placeholder="Aadhar Number"
                       maxlength="12" required pattern="[0-9]{12}"
                       title="Aadhar must be 12 digits">
            </div>

            <!-- ADDRESS -->
            <input type="text" class="full-width"
                   th:field="*{address}" placeholder="Address" required>

            <div class="pin-title">Set PIN</div>

            <!-- PIN -->
            <div class="pin-container">
                <input maxlength="1" class="pin-box pin" oninput="moveToNext(this)" pattern="[0-9]" required>
                <input maxlength="1" class="pin-box pin" oninput="moveToNext(this)" pattern="[0-9]" required>
                <input maxlength="1" class="pin-box pin" oninput="moveToNext(this)" pattern="[0-9]" required>
                <input maxlength="1" class="pin-box pin" oninput="moveToNext(this)" pattern="[0-9]" required>

                <input type="hidden" id="pinInput" th:field="*{pin}" required>

                <i class="fa-solid fa-eye-slash pin-eye" id="pinToggleIcon" onclick="togglePin()"></i>
            </div>
            <p id="ageError" style="color:red; font-weight:600; margin-top:-10px;"></p>

            <button type="submit" class="btn-submit">Create Account</button>

        </form>
    </div>
</div>


<script>
    function moveToNext(current) {
        let pins = document.querySelectorAll(".pin");
        let pinField = document.getElementById("pinInput");

        if (current.value.length === 1) {
            let next = current.nextElementSibling;
            if (next && next.classList.contains("pin")) next.focus();
        }

        let total = "";
        pins.forEach(p => total += p.value);
        pinField.value = total;
    }

    function togglePin() {
        let pins = document.querySelectorAll(".pin");
        let icon = document.getElementById("pinToggleIcon");

        let isPassword = pins[0].type === "password";

        pins.forEach(p => p.type = isPassword ? "text" : "password");

        icon.classList.toggle("fa-eye");
        icon.classList.toggle("fa-eye-slash");
    }

    window.onload = () => {
        document.querySelectorAll(".pin").forEach(p => p.type = "password");
    }
// AGE VALIDATION (Must be 18+)
document.addEventListener("DOMContentLoaded", function () {
    const dobField = document.getElementById("dobField");
    const form = document.querySelector("form");
    const ageError = document.getElementById("ageError");

    form.addEventListener("submit", function (e) {

        let dobValue = dobField.value;
        if (!dobValue) return; // Let HTML required handle it

        let dob = new Date(dobValue);
        let today = new Date();

        let age = today.getFullYear() - dob.getFullYear();
        let monthDiff = today.getMonth() - dob.getMonth();

        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < dob.getDate())) {
            age--;
        }

        if (age < 18) {
            e.preventDefault();   // stop submit
            ageError.textContent = "Age must be 18+ for Major Account.";
            return;
        }

        ageError.textContent = ""; // Clear message if valid
    });
});

</script>

</body>
</html>
